// Copyright 2014 The Azul3D Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
//
// Code generated by this program is also under
// the above license.

// glwrap is a tool for generating Go OpenGL wrappers.
package main

import (
	"io"
	"text/template"
)

const goTypesTemplate = `// Copyright 2014 The Azul3D Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
//
// This source file was automatically generated using glwrap.{{range $tag := .BuildTags}}
// +build {{$tag}}{{end}}

package {{.API}}

/*
#include "gl.h"
*/
import "C"
import "unsafe"

type(
{{range $element := .Types}}	{{.GoName}} C.{{.CName}}
{{end}}
)

// String converts from a OpenGL *uint8 string to a Go string.
func String(v *uint8) string {
	return C.GoString((*C.char)(unsafe.Pointer(v)))
}

// ByteString converts from a OpenGL *byte string to a Go string.
func ByteString(v *byte) string {
	return C.GoString((*C.char)(unsafe.Pointer(v)))
}

// Bool converts from a OpenGL uint8 boolean to a Go bool.
func Bool(v uint8) bool {
	if v == 1 {
		return true
	}
	return false
}

// GLBool converts from a Go bool to a OpenGL uint8 boolean.
func GLBool(v bool) uint8 {
	if v {
		return 1
	}
	return 0
}
`

func writeGoTypes(out io.Writer, tmplData *TmplData) error {
	tmpl := template.Must(template.New("goTypesTemplate").Parse(goTypesTemplate))
	err = tmpl.Execute(out, map[string]interface{}{
		"BuildTags": tmplData.BuildTags,
		"Types":     tmplData.Types,
		"Title":     tmplData.Title,
		"API":       tmplData.API,
	})
	if err != nil {
		return err
	}
	return nil
}
